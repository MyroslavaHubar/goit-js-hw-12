{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function fetchGallery(q, currentPage) {\n  const BASE_URL = 'https://pixabay.com';\n  const END_POINT = '/api/';\n  const url = `${BASE_URL}${END_POINT}`;\n\n  const params = {\n    key: '44406929-b6512fae58ed0703418d850ba',\n    q: q,\n    page: currentPage,\n    per_page: 15,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n  };\n\n  try {\n    const res = await axios.get(url, { params });\n    return res.data;\n  } catch {\n    console.log('Error');\n  }\n}\n","function imgTemplate(img) {\n  return `<li class=\"gallery-item\">\n\t<a class=\"gallery-link\" href=\"${img.largeImageURL}\">\n\t\t<img \n\t\t\tclass=\"gallery-image\" \n\t\t\tsrc=\"${img.previewURL}\" \n\t\t\talt=\"${img.tags}\" \n\t\t\t/>\n\t</a>\n    <div class=\"item-footer\">\n          <div class=\"item-footer-pair\">\n            <p>Likes</p>\n            <p>${img.likes}</p>\n          </div>\n          <div class=\"item-footer-pair\">\n            <p>Views</p>\n            <p>${img.views}</p>\n          </div>\n          <div class=\"item-footer-pair\">\n            <p>Comments</p>\n            <p>${img.comments}</p>\n          </div>\n          <div class=\"item-footer-pair\">\n            <p>Downloads</p>\n            <p>${img.downloads}</p>\n          </div>\n        </div>\n</li>\n`;\n}\n\nexport function galleryTemplate(images) {\n  return images.map(imgTemplate).join('');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchGallery } from './js/pixabay-api';\nimport { galleryTemplate } from './js/render-function';\n\nconst refs = {\n  formElem: document.querySelector('.form'),\n  ulElem: document.querySelector('.js-gallery'),\n  loader: document.querySelector('.loader'),\n  btnLoadMore: document.querySelector('.load-more-btn'),\n};\n\nlet query = '';\nlet currentPage = 1;\nlet maxPage = 1;\nconst perPage = 15;\n\nrefs.formElem.addEventListener('submit', requestImgGallery);\n\nasync function requestImgGallery(e) {\n  e.preventDefault();\n\n  query = e.target.elements.searchField.value.trim();\n  if (!query) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Enter your details. Please try again!',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  currentPage = 1;\n  showLoader();\n  hideLoadBtn();\n  try {\n    const data = await fetchGallery(query, currentPage);\n    // console.log(data);\n    maxPage = Math.ceil(data.total / perPage);\n    if (data.total === 0) {\n      hideLoader();\n      showError();\n    }\n    const markup = galleryTemplate(data.hits);\n    refs.ulElem.innerHTML = markup;\n    lightbox.refresh();\n  } catch {\n    warningError();\n  }\n  updateBtnStatus();\n  hideLoader();\n  refs.formElem.reset();\n}\n\nrefs.btnLoadMore.addEventListener('click', async () => {\n  currentPage++;\n  showLoader();\n  hideLoadBtn();\n  try {\n    const data = await fetchGallery(query, currentPage);\n    if (data.total === 0) {\n      showError();\n    }\n    const markup = galleryTemplate(data.hits);\n    refs.ulElem.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n    scrollOldElement();\n  } catch {\n    warningError();\n  }\n  updateBtnStatus();\n  hideLoader();\n});\n\n//======================================================\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nlightbox.refresh();\n\n//====================================================\n\nfunction showLoader() {\n  refs.loader.classList.remove('hidden');\n}\n\nfunction hideLoader() {\n  refs.loader.classList.add('hidden');\n}\n\n//====================================================\n\nfunction showLoadBtn() {\n  refs.btnLoadMore.classList.remove('hidden');\n}\n\nfunction hideLoadBtn() {\n  refs.btnLoadMore.classList.add('hidden');\n}\n\n//====================================================\n\nfunction updateBtnStatus() {\n  if (currentPage >= maxPage) {\n    hideLoadBtn();\n    if (maxPage !== 0) {\n      iziToast.info({\n        title: '',\n        message:\n          'We are sorry, but you have reached the end of search results.',\n        position: 'bottomCenter',\n      });\n    }\n  } else {\n    showLoadBtn();\n  }\n}\n\n//======================================================\n\nfunction scrollOldElement() {\n  const liElem = refs.ulElem.children[0];\n  const heightElem = liElem.getBoundingClientRect().height;\n\n  scrollBy({\n    top: heightElem * 2,\n    behavior: 'smooth',\n  });\n}\n\n//======================================================\n\nfunction showError() {\n  iziToast.error({\n    title: '',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n    messageLineHeight: '1.5',\n    messageSize: '16',\n    messageColor: '#fff',\n    position: 'topCenter',\n    backgroundColor: '#ef4040',\n    icon: false,\n  });\n}\n\nfunction warningError() {\n  iziToast.warning({\n    title: '',\n    message: 'Sorry! There was a problem with the server!',\n    messageLineHeight: '1.5',\n    messageSize: '16',\n    messageColor: '#fff',\n    position: 'topRight',\n    backgroundColor: '#ef4040',\n    icon: false,\n  });\n}\n\n//========================================================\n"],"names":["fetchGallery","q","currentPage","url","params","axios","imgTemplate","img","galleryTemplate","images","refs","query","maxPage","perPage","requestImgGallery","iziToast","showLoader","hideLoadBtn","data","hideLoader","showError","markup","lightbox","warningError","updateBtnStatus","scrollOldElement","SimpleLightbox","showLoadBtn","heightElem"],"mappings":"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"}